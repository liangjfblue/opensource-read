设计技巧

- 1.数据分片, 降低锁的范围, 减少锁的冲突
- 2.数据的存储:map(key-hash值, value-分片的队列索引)用于快速定位, 循环队列用于存数据. (看此)[https://github.com/golang/go/issues/9477]
- 3.不处理碰撞, 碰撞会更新旧值
- 4.循环队列利用切片, 每个条目一个分片的条目缓冲区复用, 减少内存的分配, 降低gc压力
- 5.字节队列, 存字节, 而非数据指针, 降低gc压力
- 6.包装条目, 统一字节管理
- 7.使用了Uvarint编码解码
- 8.切片和字符串转换通过unsafe.point和反射来转换, 避免中间边变量的产生
- 9.队列的索引0不用 用来方便判断队列是否空
- 10.FLV-64a算法改进, 速度比标准库的快4倍
